#!/bin/bash

INPUT1=$1
INPUT2=$2
HDFS_PATH=$3
LOCAL_PATH=$4
PARTITIONS=$5

spark-submit \
    --master local[10] \
    --jars $HOME/Spark/2.4/jars/geospark-1.2.0.jar,$HOME/Spark/2.4/jars/scallop_2.11-3.1.5.jar \
    --class edu.ucr.dblab.sdcel.DCELPartitioner2 ~/RIDIR/Code/DCEL/target/scala-2.11/sdcel_2.11-0.1.jar \
    --input1 $INPUT1 \
    --input2 $INPUT2 \
    --partitions 64 \
    --apath $HDFS_PATH/edgesA \
    --bpath $HDFS_PATH/edgesB \
    --qpath $LOCAL_PATH/quadtree.wkt \
    --epath $LOCAL_PATH/boundary.wkt
