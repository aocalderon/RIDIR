package edu.ucr.dblab.quadtree

import com.vividsolutions.jts.geom.Envelope

object Quadtree {  
  def create[T](boundary: Envelope, lineages: List[String]): StandardQuadTree[T] = {
    val maxLevel = lineages.map(_.size).max
    val quadtree = new StandardQuadTree[T](new QuadRectangle(boundary), 0, 1, maxLevel)
    quadtree.split()
    println
    lineages.sorted.foreach(println)
    for(lineage <- lineages.sorted){
      println("1. Lineage: " + lineage)
      val arr = lineage.map(_.toInt - 48)
      var current = quadtree
      println("2. First current: " + current)
      for(position <- arr.slice(0, arr.size - 1)){
        println("3. Position: " + position)
        val regions = current.getRegions()
        println("4. Regions:" + regions.size)
        current = regions(position)
        println("5. Next current: " + current)
        if(current.getRegions == null){
          current.split()
        }
      }
    }
    quadtree.assignPartitionLineage()
    quadtree.assignPartitionIds()

    quadtree
  }
}
